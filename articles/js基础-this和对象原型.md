# js基础-this和对象原型

## 关于this

this是一个关键字，被自动定义在所有函数的作用域中。
this提供了一种更优雅的方式来隐式“传递”一个对象引用，因此可以将API设计的更加简洁并且易于复用。

函数可以自动引用合适的上下文对象是非常重要的。

``` js
function foo(num) {
    console.log('foo:', num);
    this.count++;
    console.log(this)   //window对象
}

foo.count = 0;

for (var i = 0; i < 10; i++) {
    if (i > 5) {
        foo(i)
    }
}

console.log(foo.count); //0

//所有打印
//foo: 6
//foo: 7
//foo: 8
//foo: 9
//0
```

打印和我们预期的不一样，为了达到一样，我们可以这样做：
1.函数标示符替代this来引用函数对象

函数分为具名函数和匿名函数，具名函数中，函数名可以指向this,但是匿名函数就找不到名称指向this.

修改代码:

```js
function foo(num) {
    console.log('foo:', num);
    foo.count++
}

foo.count = 0;

for (var i = 0; i < 10; i++) {
    if (i > 5) {
        foo(i)
    }
}

console.log(foo.count);

//所有打印
// foo: 6
// foo: 7
// foo: 8
// foo: 9
// 4
```

强制this指向函数，使用call()函数

**注意**：this在任何时候都不等于函数的作用域。在js内容，作用域确实和对象类似，可见的标示符都是它的属性。但是作用域“对象”无法通过js代码访问（也就是作用域只和词法作用域有关于，而和运行时是无关的）， 它存在与javascript引擎内。

this 和作用域是不可以混合的,this既不指向自身，也不指向函数的词法作用域。this实际上是在函数被调用的时候发生的绑定，它指向什么完全取决于函数在哪里被调用。

> this 是在运行时进行绑定的，并不是在编写时绑定，它的上下文取决于函数调用时的各种条件。this 的绑定和函数声明的位置没有任何关系，只取决于函数的调用方式。

> 当一个函数被调用时，会创建一个活动记录(有时候也称为执行上下文)。这个记录会包 含函数在哪里被调用(调用栈)、函数的调用方法、传入的参数等信息。this 就是记录的 其中一个属性，会在函数执行的过程中用到