# 页面渲染机制

前端的主要工作界面是浏览器，所以先了解一下浏览器的组成，才能更加明白页面在浏览器中是如何渲染的。

### 浏览器组成

1. 用户界面

2. 网络

3. JavaScript引擎

4. 渲染引擎

5. UI后端

6. JavaScript解释器

7. 持久化数据存储



我们平时的开发工作中接触的最多的就是渲染引擎。在不同的浏览器内核中，渲染引擎的工作原理会有一点点不一样。下面主要讲在chrome浏览器中是如何工作的。

页面加载和渲染全过程

1. HTML的加载

2. 其他静态资源下载

   HTML在解析的过程中，如果发现HTML文本中夹杂着一些外部的资源链接。比如CSS JS 图片等时，会立即启用别的线程下载这些静态资源。这里有个**特殊的是 JS 文件，当遇到JS文件 ， HTML的解析会停止下来，等JS 文件下载结束并且执行完，HTML的解析工作再接着来**。这样做是因为JS里可能会出现修改已经完成的解析结果，有白白浪费资源的风险，所以HTML解析干脆等JS折腾完了再干。 

3. DOM树创建

4. CSSOM创建

5. 渲染树构建

渲染树就是对 dom 树和 cssom 树的结合。



1. 布局计算
2. 渲染



### 渲染树的构建及渲染机制

渲染树是DOM树和CSSOM树的结合，得到一个可以知道每个节点会应用什么样式的数据结果。

1. 渲染树的根是**HTML**节点。

2. 渲染树和DOM树的结构并不完全一致。

   dom 树中“diaplay: none”的节点不会在渲染树中。

   

3. 样式优先级

当一个dom元素收到多条样式控制的时候，样式的优先级控制应该是：

**内联样式 > ID选择器 > 类选择器 > 标签选择器 > 通用选择器 > 继承样式 > 浏览器默认样式**

> Tips 
>
> 1.
>
> 2.为什么兄弟选择器只能向后查找兄弟元素。
>
> 这是因为在生成渲染树的时候会遍历DOM节点来生成渲染树的节点。当遇到兄弟选择器的时候，它前面的兄弟元素在渲染树上的节点已经生成完毕，而它后面的兄弟节点还没有生成。
>
> 
>
> 



### 重排和重绘

什么情况下会重排？

什么情况下会重绘？

如何减少重排

如何减少重绘